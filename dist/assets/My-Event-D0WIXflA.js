var fe=Object.defineProperty;var ge=(s,e,a)=>e in s?fe(s,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[e]=a;var A=(s,e,a)=>ge(s,typeof e!="symbol"?e+"":e,a);import{Q as p,R as z,j as n,w as K,b as B,r as u,b6 as he,b7 as me,b8 as ve,b9 as xe,ba as be,bb as ye,bc as Ee,m as je,bd as Ce,V as we,be as H,aH as ke,aI as Pe,L as Ae,bf as j,B as O,u as Se}from"./index-BrZH0d3x.js";import{P as Ne}from"./protected-CXzhvSTF.js";import{P as Le}from"./PageHeader-CDe-_0Tr.js";import{u as Fe,P as G}from"./Pagination-B3qqXmWs.js";import{C as J,N as Te}from"./CardMyEvent-Bb5biKka.js";import{C as Ie}from"./Dialog-BYEb2l1K.js";import{S as N}from"./index-k6O9rKcn.js";import{c as Re,d as Q}from"./event.type-CzgUQE7A.js";import{F as Oe}from"./FormGroup-CK3EjtU2.js";import"./index-BwXeDKHI.js";import"./CircularProgress-DWGzp6J_.js";const Me=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent),W=s=>Array.isArray(s)&&s.every(e=>typeof e=="object"&&!(e instanceof Array)),_e=s=>Array.isArray(s)&&s.every(e=>Array.isArray(e)),Ue=s=>Array.from(s.map(e=>Object.keys(e)).reduce((e,a)=>new Set([...e,...a]),[])),$e=(s,e)=>{e=e||Ue(s);let a=e,r=e;W(e)&&(a=e.map(o=>o.label),r=e.map(o=>o.key));const c=s.map(o=>r.map(i=>Ve(i,o)));return[a,...c]},Ve=(s,e)=>{const a=s.replace(/\[([^\]]+)]/g,".$1").split(".").reduce(function(r,c,o,i){const d=r[c];if(d==null)i.splice(1);else return d},e);return a===void 0?s in e?e[s]:"":a},De=s=>typeof s>"u"||s===null?"":s,X=(s,e=",",a='"')=>s.filter(r=>r).map(r=>r.map(c=>De(c)).map(c=>`${a}${c}${a}`).join(e)).join(`
`),Be=(s,e,a,r)=>X(e?[e,...s]:s,a,r),He=(s,e,a,r)=>X($e(s,e),a,r),Ge=(s,e,a,r)=>e?`${e.join(a)}
${s}`:s.replace(/"/g,'""'),Y=(s,e,a,r)=>{if(W(s))return He(s,e,a,r);if(_e(s))return Be(s,e,a,r);if(typeof s=="string")return Ge(s,e,a);throw new TypeError('Data should be a "String", "Array of arrays" OR "Array of objects" ')},Z=(s,e,a,r,c)=>{const o=Y(s,a,r,c),i=Me()?"application/csv":"text/csv",d=new Blob([e?"\uFEFF":"",o],{type:i}),x=`data:${i};charset=utf-8,${e?"\uFEFF":""}${o}`,b=window.URL||window.webkitURL;return typeof b.createObjectURL>"u"?x:b.createObjectURL(d)},ee={data:p.oneOfType([p.string,p.array,p.func]).isRequired,headers:p.array,target:p.string,separator:p.string,filename:p.string,uFEFF:p.bool,onClick:p.func,asyncOnClick:p.bool,enclosingCharacter:p.string},se={separator:",",filename:"generatedBy_react-csv.csv",uFEFF:!0,asyncOnClick:!1,enclosingCharacter:'"'},Je={target:"_blank"};class q extends z.Component{constructor(e){super(e),this.state={}}buildURI(){return Z(...arguments)}componentDidMount(){const{data:e,headers:a,separator:r,enclosingCharacter:c,uFEFF:o,target:i,specs:d,replace:x}=this.props;this.state.page=window.open(this.buildURI(e,o,a,r,c),i,d,x)}getWindow(){return this.state.page}render(){return null}}A(q,"defaultProps",Object.assign(se,Je)),A(q,"propTypes",ee);var L;let Qe=(L=class extends z.Component{constructor(e){super(e),this.buildURI=this.buildURI.bind(this)}buildURI(){return Z(...arguments)}handleLegacy(e,a=!1){if(window.navigator.msSaveOrOpenBlob){e.preventDefault();const{data:r,headers:c,separator:o,filename:i,enclosingCharacter:d,uFEFF:x}=this.props,b=a&&typeof r=="function"?r():r;let C=new Blob([x?"\uFEFF":"",Y(b,c,o,d)]);return window.navigator.msSaveBlob(C,i),!1}}handleAsyncClick(e){const a=r=>{if(r===!1){e.preventDefault();return}this.handleLegacy(e,!0)};this.props.onClick(e,a)}handleSyncClick(e){if(this.props.onClick(e)===!1){e.preventDefault();return}this.handleLegacy(e)}handleClick(){return e=>{if(typeof this.props.onClick=="function")return this.props.asyncOnClick?this.handleAsyncClick(e):this.handleSyncClick(e);this.handleLegacy(e)}}render(){const{data:e,headers:a,separator:r,filename:c,uFEFF:o,children:i,onClick:d,asyncOnClick:x,enclosingCharacter:b,...C}=this.props,F=typeof window>"u"?"":this.buildURI(e,o,a,r,b);return n.jsx("a",{download:c,...C,ref:g=>this.link=g,target:"_self",href:F,onClick:this.handleClick(),children:i})}},A(L,"defaultProps",se),A(L,"propTypes",ee),L);const qe=Qe,ze=({t:s})=>{const e=B(t=>t.persistedReducer.category.categories),a=B(t=>t.persistedReducer.user.user),[r,c]=u.useState(Re),[o,{isLoading:i}]=he(),[d,{isLoading:x}]=me(),[b,{isLoading:C}]=ve(),[l,F]=u.useState(),[g,te]=u.useState([]),[h,ne]=u.useState(xe.ALL),[E,M]=u.useState(!1),[_,w]=u.useState(!1),[m,U]=u.useState(Q),[$,T]=u.useState(),[f,I]=u.useState([]),{data:S,isSuccess:ae,isFetching:re,refetch:k}=be({userId:a==null?void 0:a.id,params:{...r,eventPrivacy:h}}),le=u.useCallback(()=>{if(h==="ALL")return l==null?void 0:l.totalCount;if(h==="PUBLIC")return l==null?void 0:l.totalPublic;if(h==="PRIVATE")return l==null?void 0:l.totalPrivate},[l==null?void 0:l.totalCount,l==null?void 0:l.totalPublic,l==null?void 0:l.totalPrivate,h]);u.useEffect(()=>{S&&(te(S.items),F(S.metadata))},[S]);const y=Fe(le(),4);u.useEffect(()=>{c({...r,page:y.currentPage})},[y.currentPage]),u.useEffect(()=>{M(!1),k()},[h]),u.useEffect(()=>{I(E?g.map(t=>t.id):[])},[E]);const ce=t=>{switch(t){case"ALL":return l==null?void 0:l.totalCount;case"PUBLIC":return l==null?void 0:l.totalPublic;case"PRIVATE":return l==null?void 0:l.totalPrivate}},R=({value:t,label:v},P)=>{U(pe=>({...pe,[P]:{value:t,label:v}}))},oe=()=>{var t;c({...r,type:(t=m.status)==null?void 0:t.value,categoryIds:m.category.value})},ie=t=>{switch(w(!0),t.label){case"Move to Publics":T(j.PUBLIC);break;case"Move to Privates":T(j.PRIVATE);break;case"Move to Trash":T(j.TRASH);break}},V=t=>{if(f.includes(t)){const v=f.filter(P=>P!==t);I(v)}else I([...f,t])},ue=async()=>{switch($){case j.PUBLIC:try{f.length&&await o(f).unwrap()&&(k(),O.success("Move to public successfully"),w(!1))}catch(t){console.log(t)}break;case j.PRIVATE:try{f.length&&await d(f).unwrap()&&(k(),O.success("Move to private successfully"),w(!1))}catch(t){console.log(t)}break;case j.TRASH:try{f.length&&await b(f).unwrap()&&(k(),O.success("Move to trash successfully"),w(!1))}catch(t){console.log(t)}break}},de=t=>{c({...r,page:1}),y.goToPage(1),ne(t)},D=()=>{k()};return n.jsxs("div",{className:"flex flex-col flex-1",children:[n.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[n.jsxs("span",{className:"text-header",children:[s("management.label_event"),":"]}),n.jsx("div",{children:ye.map((t,v)=>n.jsx(Ee,{type:"filter",text:t.label,qty:ce(t==null?void 0:t.value),value:t==null?void 0:t.value,active:h,onClick:P=>{de(P)}},`filter-${v}`))})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3 md:gap-x-6 xl:grid-cols-6",children:[n.jsx(N,{options:je,value:m==null?void 0:m.status,placeholder:s("management.label_status"),onChange:t=>R(t,"status")}),n.jsx(N,{options:e.map(t=>({value:t.id,label:t.name})),value:m==null?void 0:m.category,placeholder:s("management.label_category"),onChange:t=>R(t,"category")}),n.jsx(N,{options:Ce,value:m.eventTicketType,placeholder:s("management.label_price"),onChange:t=>R(t,"eventTicketType")}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsx("button",{className:"btn bg-primary flex text-white !gap-[5px]",onClick:oe,children:s("management.filter")}),n.jsx("button",{className:"btn btn--outline blue !h-[44px]",onClick:()=>{U(Q)},children:s("management.clear")})]})]}),n.jsx(we,{wrapperClass:"lg:w-[326px]",placeholder:s("management.search_event"),onChange:t=>{c({...r,search:t})}})]}),n.jsxs("div",{className:"flex flex-col-reverse gap-4 mt-4 mb-5 md:flex-row md:justify-between md:items-end md:mt-5 md:mb-6",children:[n.jsxs("p",{className:"text-header",children:[" ",s("management.view_events"),": ",y.showingOf()]}),n.jsx("div",{className:"md:min-w-[280px]",children:n.jsx(N,{options:h==="ALL"?[H[2]]:H.filter(t=>t.value!==h),placeholder:s("management.select_action"),onChange:ie})})]}),g.length!==0&&n.jsx(Oe,{sx:{display:"flex",flexDirection:"row"},children:n.jsx(ke,{sx:{"& .MuiFormControlLabel-label":{color:"var(--header)"}},control:n.jsx(Pe,{sx:{color:"var(--header)"},checked:E,onChange:()=>{M(!E)}}),label:s("management.select_all")})}),re&&n.jsx(Ae,{}),g.length!==0&&n.jsxs("div",{className:"flex flex-col gap-[22px]",children:[n.jsx("div",{className:"w-full grid grid-cols-1 lgl:grid-cols-2 gap-10",children:g==null?void 0:g.map((t,v)=>n.jsx(J,{event:t,checkedAll:E,eventIds:f,onChecked:V,refect:D},`event-${v}`))}),y.maxPage>1&&n.jsx(G,{pagination:y})]}),n.jsxs("div",{className:"flex flex-col gap-[22px]",children:[n.jsx("div",{className:"w-full grid grid-cols-1 mdl:grid-cols-2 gap-10",children:Array(4).fill(1).map((t,v)=>n.jsx(J,{event:t,checkedAll:E,eventIds:f,onChecked:V,refect:D},`event-${v}`))}),y.maxPage>1&&n.jsx(G,{pagination:y})]}),ae&&g.length===0&&n.jsx(Te,{}),_&&n.jsx(Ie,{title:"Action Event",description:`Are you sure want ${$} these events`,open:_,setOpen:t=>{w(t)},action:"Ok",onHandle:ue,disabled:i||x||C})]})},Ke=K("my_event")(ze),We=[["firstname","lastname","email"],["John","Doe","johndoe@domain.com"],["Jane","Doe","janedoe@domain.com"]],Xe=({t:s})=>{const e=Se();return n.jsx(Ne,{children:n.jsxs("div",{className:"min-h-screen",children:[n.jsx(Le,{title:s("header.title")}),n.jsx("div",{className:"flex flex-col-reverse gap-4 mb-5 md:flex-col lg:flex-row lg:justify-between",children:n.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:gap-[14px]",children:[n.jsxs("button",{onClick:()=>{e("/organization/event/create-event")},className:"btn btn--primary",children:[s("body.title")," ",n.jsx("i",{className:"icon-circle-plus-regular"})]}),n.jsxs(qe,{className:"btn btn--outline blue !h-[44px]",data:We,children:[s("body.link_csv")," ",n.jsx("i",{className:"icon-file-export-solid"})]})]})}),n.jsx(Ke,{})]})})},ds=K("my_event")(Xe);export{ds as default};
